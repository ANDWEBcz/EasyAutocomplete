function EasyAutocomplete(a,b){function c(){return r.checkDataUrlProperties()?r.checkRequiredProperties()?(d(),void f()):void s.error("Will not work without mentioned properties."):void s.error("One of options variables 'data' or 'url' must be defined.")}function d(){function b(){var b=$("<div>").addClass(q.getValue("WRAPPER_CSS_CLASS")),c=a.outerWidth();b.css("width",c),a.wrap(b)}function c(){a.unwrap()}function d(){var b=$("<div>").addClass(q.getValue("CONTAINER_CLASS"));b.attr("id",e()).prepend($("<ul>")),function(){b.on("show",function(){switch(r.get("list").showAnimation.type){case"slide":var a=r.get("list").showAnimation.time,c=r.get("list").showAnimation.callback;b.find("ul").slideDown(a,c);break;case"fade":var a=r.get("list").showAnimation.time,c=r.get("list").showAnimation.callback;b.find("ul").fadeIn(a),c;break;default:b.find("ul").show()}}).on("hide",function(){switch(r.get("list").hideAnimation.type){case"slide":var a=r.get("list").hideAnimation.time,c=r.get("list").hideAnimation.callback;b.find("ul").slideUp(a,c);break;case"fade":var a=r.get("list").hideAnimation.time,c=r.get("list").hideAnimation.callback;b.find("ul").fadeOut(a,c);break;default:b.find("ul").hide()}}).on("selectElement",function(){b.find("ul li").removeClass("selected"),b.find("ul li:nth-child("+(w+1)+")").addClass("selected")}).on("loadElements",function(c,d,e){var f="",h=($("<ul>"),b.find("ul"));h.empty();for(var i=0,k=d.length;k>i;i+=1)f=$("<li><span></span></li>"),function(){var b=i,c=r.get("getValue")(d[b]);f.find("span").on("click",function(){a.val(c),j(b)}).html(g(c,e))}(),h.append(f)})}(),a.after(b)}function f(){a.next("."+q.getValue("CONTAINER_CLASS")).remove()}function g(a,b){return r.get("highlightPhrase")&&""!==b?h(a,b):a}function h(a,b){return(a+"").replace(new RegExp("("+b+")","gi"),"<b>$1</b>")}a.parent().hasClass(q.getValue("WRAPPER_CSS_CLASS"))&&(f(),c()),b(),d(),u=$("#"+e()),r.placeholder!==!1&&a.attr("placeholder",r.placeholder)}function e(){var b=a.attr("id");if(void 0===b||null===b){do b=q.getValue("CONTAINER_ID")+Math.rand(1e4);while(0==$("#"+b).length)}else b=q.getValue("CONTAINER_ID")+b;return b}function f(){function b(){t("autocompleteOff",!0)&&n(),c(),d(),e(),f(),m()}function c(){a.off("keyup").keyup(function(b){function c(){if("required"!==r.get("data")){var b=a.val();v=g(r.get("data")),k(v,b),h()}"required"!==r.get("url")&&$.ajax({url:r.get("url"),dataType:r.get("dataType")}).done(function(b){var c=b.length;if(0!==c){var d=a.val();v=g(b),k(v,d),h(),r.get("ajaxCallback")()}}).fail(function(){s.warning("Fail to load response data")}).always(function(){})}switch(b.keyCode){case 27:i(),l();break;case 38:b.preventDefault(),v.length>0&&w>0&&(w-=1,a.val(r.get("getValue")(v[w])),j(w));break;case 40:v.length>0&&w<v.length-1&&(b.preventDefault(),w+=1,a.val(r.get("getValue")(v[w])),j(w));break;default:c()}})}function d(){a.keydown(function(){})}function e(){a.off("keypress").keypress(function(){})}function f(){a.focus(function(){i()})}function m(){a.blur(function(){setTimeout(function(){i()},250)})}function n(){a.attr("autocomplete","off")}b()}function g(b){function c(a){var b=[];return $(a).find(r.get("xmlElementName")).each(function(){b.push(this)}),b}function d(a,b){var c=[],d="";if(r.get("list").matching.enabled)for(var e=0,f=a.length;f>e;e+=1)d=r.get("getValue")(a[e]),r.get("list").matching.caseSensitive||("string"==typeof d&&(d=d.toLowerCase()),b=b.toLowerCase()),d.search(b)>-1&&c.push(a[e]);else c=a;return c}function e(a){return a.length>r.get("list").maxNumberOfElements&&(a=a.slice(0,r.get("list").maxNumberOfElements)),a}function f(a){return r.get("list").sort.enabled&&a.sort(r.get("list").sort.method),a}var g=a.val();return"xml"===r.get("dataType")&&(b=c(b)),b=d(b,g),b=e(b),b=f(b)}function h(){u.trigger("show"),j(w)}function i(){u.trigger("hide")}function j(a){u.trigger("selectElement",a)}function k(a,b){u.trigger("loadElements",[a,b])}function l(){a.trigger("blur")}function m(a){function b(){"xml"==a.dataType&&(a.getValue||(a.getValue=function(a){return $(a).text()}),a.list||(a.list={}),a.list.sort||(a.list.sort={}),a.list.sort.method=function(b,c){return b=a.getValue(b),c=a.getValue(c),c>b?-1:b>c?1:0},a.list.matching||(a.list.matching={}),a.list.matching.method=function(b,c){return b=a.getValue(b),c=a.getValue(c),b===c?!0:!1})}function c(){function b(a,c){var d=a||{};for(var e in a)void 0!==c[e]&&null!==c[e]&&("object"!=typeof c[e]?d[e]=c[e]:b(a[e],c[e]));return d}e=b(e,a)}function d(a){return void 0!==e[a]&&null!==e[a]?!0:!1}var e={data:"list-required",url:"list-required",dataType:"json",xmlElementName:"",getValue:function(a){return a},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},list:{sort:{enabled:!1,method:function(a,b){return b>a?-1:a>b?1:0}},maxNumberOfElements:6,matching:{enabled:!1,caseSensitive:!1,method:function(a,b){return a===b?!0:!1}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}}},highlightPhrase:!0};b(),c(),this.get=function(a){return e[a]},this.equals=function(a,b){return d(a)&&e[a]===b?!0:!1},this.checkDataUrlProperties=function(){return"list-required"===e.url&&"list-required"===e.data?!1:!0},this.checkRequiredProperties=function(){for(var a in e)if("required"===e[a])return s.error("Option "+a+" must be defined"),!1;return!0}}function n(){var a={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"CONTAINER-ID",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(b){return a[b]}}function o(){this.error=function(a){console.log("ERROR: "+p.name+": "+a)},this.warning=function(a){console.log("WARNING: "+p.name+": "+a)}}var p={name:"easy autocomplete"},q=new n,r=new m(b),s=new o,t=r.equals,a=a,u="",v=[],w=-1;this.getConfiguration=function(){return r},this.getConstants=function(){return q},this.getContainer=function(){return u},this.build=function(){d()},this.init=function(){c()}}$.fn.easyAutocomplete=function(a){new EasyAutocomplete(this,a).init()};